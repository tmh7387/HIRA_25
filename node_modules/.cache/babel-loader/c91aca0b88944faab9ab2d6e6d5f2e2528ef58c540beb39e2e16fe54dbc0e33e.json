{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tmh73\\\\Aviation Synergy\\\\MaXwell AI - General\\\\HIRA_25\\\\src\\\\components\\\\HazardIdentification.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { useForm, useFieldArray } from 'react-hook-form';\nimport { Plus, Trash2, PlusCircle, MinusCircle } from 'lucide-react';\nimport { v4 as uuidv4 } from 'uuid';\nimport useFormStore from '../stores/formStore';\nimport { supabase } from '../services/supabase';\nimport { useHistory } from 'react-router-dom';\n\n// Other component definitions...\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function HazardIdentification({\n  onSubmit,\n  initialData\n}) {\n  _s();\n  const {\n    hazards,\n    updateFormData\n  } = useFormStore();\n  const history = useHistory(); // Use useHistory hook\n\n  // Create default event structure\n  const defaultEvent = {\n    uniqueId: uuidv4(),\n    name: '',\n    hazards: [{\n      uniqueId: uuidv4(),\n      description: '',\n      consequences: [{\n        uniqueId: uuidv4(),\n        description: '',\n        currentControls: ''\n      }]\n    }]\n  };\n\n  // Get initial events from various sources, with fallback to default\n  const initialEvents = initialData !== null && initialData !== void 0 && initialData.events || ((hazards === null || hazards === void 0 ? void 0 : hazards.events) || []).length > 0 ? hazards.events : [defaultEvent];\n  const {\n    register,\n    control,\n    handleSubmit,\n    watch\n  } = useForm({\n    defaultValues: {\n      events: initialEvents\n    }\n  });\n\n  // Watch form values for debugging\n  const watchEvents = watch('events');\n  const {\n    fields: events,\n    append: appendEvent,\n    remove: removeEvent\n  } = useFieldArray({\n    control,\n    name: \"events\"\n  });\n  const handleFormSubmit = async data => {\n    // Ensure all IDs are preserved and data is properly structured\n    const formattedData = {\n      events: data.events.map(event => ({\n        uniqueId: event.uniqueId || uuidv4(),\n        name: event.name,\n        hazards: event.hazards.map(hazard => ({\n          uniqueId: hazard.uniqueId || uuidv4(),\n          description: hazard.description,\n          consequences: hazard.consequences.map(consequence => ({\n            uniqueId: consequence.uniqueId || uuidv4(),\n            description: consequence.description,\n            currentControls: consequence.currentControls || ''\n          }))\n        }))\n      }))\n    };\n\n    // Update form store before submitting\n    updateFormData(2, formattedData);\n\n    // Submit the data\n    await supabase.from('hazards').insert(formattedData.events.flatMap(event => event.hazards.map(hazard => ({\n      event_id: event.uniqueId,\n      description: hazard.description,\n      consequences: hazard.consequences\n    }))));\n    onSubmit(formattedData);\n    history.push('/risk-assessment'); // Navigate to the Risk Assessment page\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6 max-w-6xl mx-auto p-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow-md rounded-lg p-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold text-gray-800 mb-6\",\n        children: \"Hazard Identification\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(handleFormSubmit),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-8\",\n          children: [events.map((event, eventIndex) => /*#__PURE__*/_jsxDEV(HazardEvent, {\n            eventIndex: eventIndex,\n            register: register,\n            control: control,\n            removeEvent: removeEvent\n          }, event.uniqueId || eventIndex, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => appendEvent(defaultEvent),\n              className: \"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200\",\n              children: [/*#__PURE__*/_jsxDEV(Plus, {\n                className: \"h-4 w-4 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 109,\n                columnNumber: 17\n              }, this), \"Add Safety Event\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\",\n              children: \"Next Step\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n_s(HazardIdentification, \"NGR+drX9SoRKXyO+YfOYn3dAXJo=\", false, function () {\n  return [useFormStore, useHistory, useForm, useFieldArray];\n});\n_c = HazardIdentification;\nHazardIdentification.propTypes = {\n  onSubmit: PropTypes.func.isRequired,\n  initialData: PropTypes.shape({\n    events: PropTypes.arrayOf(PropTypes.shape({\n      uniqueId: PropTypes.string,\n      name: PropTypes.string,\n      hazards: PropTypes.arrayOf(PropTypes.shape({\n        uniqueId: PropTypes.string,\n        description: PropTypes.string,\n        consequences: PropTypes.arrayOf(PropTypes.shape({\n          uniqueId: PropTypes.string,\n          description: PropTypes.string,\n          currentControls: PropTypes.string\n        }))\n      }))\n    }))\n  })\n};\nvar _c;\n$RefreshReg$(_c, \"HazardIdentification\");","map":{"version":3,"names":["React","PropTypes","useForm","useFieldArray","Plus","Trash2","PlusCircle","MinusCircle","v4","uuidv4","useFormStore","supabase","useHistory","jsxDEV","_jsxDEV","HazardIdentification","onSubmit","initialData","_s","hazards","updateFormData","history","defaultEvent","uniqueId","name","description","consequences","currentControls","initialEvents","events","length","register","control","handleSubmit","watch","defaultValues","watchEvents","fields","append","appendEvent","remove","removeEvent","handleFormSubmit","data","formattedData","map","event","hazard","consequence","from","insert","flatMap","event_id","push","className","children","fileName","_jsxFileName","lineNumber","columnNumber","eventIndex","HazardEvent","type","onClick","_c","propTypes","func","isRequired","shape","arrayOf","string","$RefreshReg$"],"sources":["C:/Users/tmh73/Aviation Synergy/MaXwell AI - General/HIRA_25/src/components/HazardIdentification.jsx"],"sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useForm, useFieldArray } from 'react-hook-form';\r\nimport { Plus, Trash2, PlusCircle, MinusCircle } from 'lucide-react';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport useFormStore from '../stores/formStore';\r\nimport { supabase } from '../services/supabase';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\n// Other component definitions...\r\n\r\nexport default function HazardIdentification({ onSubmit, initialData }) {\r\n  const { hazards, updateFormData } = useFormStore();\r\n  const history = useHistory(); // Use useHistory hook\r\n\r\n  // Create default event structure\r\n  const defaultEvent = {\r\n    uniqueId: uuidv4(),\r\n    name: '',\r\n    hazards: [{\r\n      uniqueId: uuidv4(),\r\n      description: '',\r\n      consequences: [{\r\n        uniqueId: uuidv4(),\r\n        description: '',\r\n        currentControls: ''\r\n      }]\r\n    }]\r\n  };\r\n\r\n  // Get initial events from various sources, with fallback to default\r\n  const initialEvents = initialData?.events || \r\n                       (hazards?.events || []).length > 0 ? hazards.events : \r\n                       [defaultEvent];\r\n\r\n  const { register, control, handleSubmit, watch } = useForm({\r\n    defaultValues: {\r\n      events: initialEvents\r\n    }\r\n  });\r\n\r\n  // Watch form values for debugging\r\n  const watchEvents = watch('events');\r\n\r\n  const { fields: events, append: appendEvent, remove: removeEvent } = useFieldArray({\r\n    control,\r\n    name: \"events\"\r\n  });\r\n\r\n  const handleFormSubmit = async (data) => {\r\n    // Ensure all IDs are preserved and data is properly structured\r\n    const formattedData = {\r\n      events: data.events.map(event => ({\r\n        uniqueId: event.uniqueId || uuidv4(),\r\n        name: event.name,\r\n        hazards: event.hazards.map(hazard => ({\r\n          uniqueId: hazard.uniqueId || uuidv4(),\r\n          description: hazard.description,\r\n          consequences: hazard.consequences.map(consequence => ({\r\n            uniqueId: consequence.uniqueId || uuidv4(),\r\n            description: consequence.description,\r\n            currentControls: consequence.currentControls || ''\r\n          }))\r\n        }))\r\n      }))\r\n    };\r\n\r\n    // Update form store before submitting\r\n    updateFormData(2, formattedData);\r\n\r\n    // Submit the data\r\n    await supabase.from('hazards').insert(\r\n      formattedData.events.flatMap(event => \r\n        event.hazards.map(hazard => ({\r\n          event_id: event.uniqueId,\r\n          description: hazard.description,\r\n          consequences: hazard.consequences\r\n        }))\r\n      )\r\n    );\r\n\r\n    onSubmit(formattedData);\r\n    history.push('/risk-assessment'); // Navigate to the Risk Assessment page\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6 max-w-6xl mx-auto p-6\">\r\n      <div className=\"bg-white shadow-md rounded-lg p-6\">\r\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-6\">Hazard Identification</h2>\r\n\r\n        <form onSubmit={handleSubmit(handleFormSubmit)}>\r\n          <div className=\"space-y-8\">\r\n            {events.map((event, eventIndex) => (\r\n              <HazardEvent\r\n                key={event.uniqueId || eventIndex}\r\n                eventIndex={eventIndex}\r\n                register={register}\r\n                control={control}\r\n                removeEvent={removeEvent}\r\n              />\r\n            ))}\r\n\r\n            <div className=\"flex justify-between\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => appendEvent(defaultEvent)}\r\n                className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200\"\r\n              >\r\n                <Plus className=\"h-4 w-4 mr-2\" />\r\n                Add Safety Event\r\n              </button>\r\n\r\n              <button\r\n                type=\"submit\"\r\n                className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\"\r\n              >\r\n                Next Step\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nHazardIdentification.propTypes = {\r\n  onSubmit: PropTypes.func.isRequired,\r\n  initialData: PropTypes.shape({\r\n    events: PropTypes.arrayOf(PropTypes.shape({\r\n      uniqueId: PropTypes.string,\r\n      name: PropTypes.string,\r\n      hazards: PropTypes.arrayOf(PropTypes.shape({\r\n        uniqueId: PropTypes.string,\r\n        description: PropTypes.string,\r\n        consequences: PropTypes.arrayOf(PropTypes.shape({\r\n          uniqueId: PropTypes.string,\r\n          description: PropTypes.string,\r\n          currentControls: PropTypes.string\r\n        }))\r\n      }))\r\n    }))\r\n  })\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}